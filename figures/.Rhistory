xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1),
trans = trans_reverser('log10')) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1), trans = "log10") +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.1) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1), trans = "log10") +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.05) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
df2c
ggplot(data = df2c) +
geom_histogram(aes(x = p), binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
hist(p)
ggplot(data = df2c, aes(x = df2c$p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram(binwidth = 0.02) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
p
ggplot(data = df2c, aes(x = p)) +
geom_bar(binwidth = 0.02) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,180,by = 20), limits = c(0,180)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,180), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_bar(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,1000,by = 100), limits = c(0,1000)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,1000), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_bar(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,600,by = 100), limits = c(0,600)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,600), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_bar(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c, aes(x = p)) +
geom_histogram() +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c) +
geom_histogram(aes(x = p)) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
hist(p)
hist(p, xlim = c(0,1))
hist(p, ylim = c(0,1000), xlim = c(0,1))
ggplot(data = df2c) +
geom_histogram(aes(x = p)) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c) +
geom_histogram(aes(y = p)) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
round(p,1)
round(p,2)
round(p,3)
nSims <- 1000 #number of simulated experiments
p <-numeric(nSims) #set up empty container for all simulated p-values
obs_pwr <-numeric(nSims) #set up empty container
d_all<-numeric(nSims)
N<-60 #number of participants
for(i in 1:nSims){ #for each simulated experiment
x<-rnorm(n = N, mean = 110, sd = 10) #produce 1000 simulated participants
y<-rnorm(n = N, mean = 115, sd = 10) #produce 1000 simulated participants
z<-t.test(x,y) #perform the t-test
d<-smd(Mean.1= mean(x), Mean.2=mean(y), s.1=sd(x), s.2=sd(y), n.1=N, n.2=N, Unbiased=TRUE)
d_all[i]<-d
obs_pwr[i]<-pwr.t.test(n = N, d = d, sig.level = 0.05, type = "two.sample", alternative = "two.sided")$power
p[i]<-round(z$p.value,3) #get the p-value and store it
}
p
hist(p, ylim = c(0,1000), xlim = c(0,1:0.1))
hist(p, ylim = c(0,1000), xlim = c(0,1:0.01))
ggplot(data = df2c,aes(x=p)) +
geom_histogram(binwidth = 0.1) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c,aes(x=p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
p
ggplot(data = df2c,aes(x=p)) +
geom_histogram(binwidth = 0.005) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c,aes(x=p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c,aes(x=p)) +
geom_histogram() +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2c,aes(x=p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 79% \n Sample size: 60") +
scale_y_continuous(breaks=seq(0,200,by = 10), limits = c(0,200)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,200), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
rm(ls = list())
rm(list=ls())
nSims <- 1000 #number of simulated experiments
p <-numeric(nSims) #set up empty container for all simulated p-values
obs_pwr <-numeric(nSims) #set up empty container
d_all<-numeric(nSims)
N<-10 #number of participants
for(i in 1:nSims){ #for each simulated experiment
x<-rnorm(n = N, mean = 110, sd = 10) #produce 1000 simulated participants
y<-rnorm(n = N, mean = 115, sd = 10) #produce 1000 simulated participants
z<-t.test(x,y) #perform the t-test
d<-smd(Mean.1= mean(x), Mean.2=mean(y), s.1=sd(x), s.2=sd(y), n.1=N, n.2=N, Unbiased=TRUE)
d_all[i]<-d
obs_pwr[i]<-pwr.t.test(n = N, d = d, sig.level = 0.05, type = "two.sample", alternative = "two.sided")$power
p[i]<-round(z$p.value,3) #get the p-value and store it
}
df2a <- data.frame(p,d_all,obs_pwr)
#Calculate power in simulation
power2a <- sum(p < 0.05)/nSims*100
power2a
if(!require(tidyr)){install.packages('tidyr')}
library(tidyr)
if(!require(dplyr)){install.packages('dplyr')}
library(dplyr)
if(!require(ggplot2)){install.packages('ggplot2')}
library(ggplot2)
if(!require(pwr)){install.packages('pwr')}
library(pwr)
if(!require(MBESS)){install.packages('MBESS')}
library(MBESS)
set.seed(123)
nSims <- 1000 #number of simulated experiments
p <-numeric(nSims) #set up empty container for all simulated p-values
obs_pwr <-numeric(nSims) #set up empty container
d_all<-numeric(nSims)
N<-10 #number of participants
for(i in 1:nSims){ #for each simulated experiment
x<-rnorm(n = N, mean = 110, sd = 10) #produce 1000 simulated participants
y<-rnorm(n = N, mean = 115, sd = 10) #produce 1000 simulated participants
z<-t.test(x,y) #perform the t-test
d<-smd(Mean.1= mean(x), Mean.2=mean(y), s.1=sd(x), s.2=sd(y), n.1=N, n.2=N, Unbiased=TRUE)
d_all[i]<-d
obs_pwr[i]<-pwr.t.test(n = N, d = d, sig.level = 0.05, type = "two.sample", alternative = "two.sided")$power
p[i]<-round(z$p.value,3) #get the p-value and store it
}
df2a <- data.frame(p,d_all,obs_pwr)
#Calculate power in simulation
power2a <- sum(p < 0.05)/nSims*100
power2a
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
scale_y_continuous(breaks=seq(0,50,by = 10), limits = c(0,50)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,50), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
scale_y_continuous(breaks=seq(0,50,by = 10), limits = c(0,50)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,50), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
scale_y_continuous(breaks=seq(0,50,by = 10), limits = c(0,50)) +
scale_x_continuous(breaks=seq(0,1,by=0.1), limits = c(0,1)) +
coord_cartesian(ylim = c(0,50), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
coord_cartesian(ylim = c(0,50), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
coord_cartesian(ylim = c(0,1000), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
coord_cartesian(ylim = c(0,250), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
nSims <- 1000 #number of simulated experiments
p <-numeric(nSims) #set up empty container for all simulated p-values
obs_pwr <-numeric(nSims) #set up empty container
d_all<-numeric(nSims)
N<-10 #nu
for(i in 1:nSims){ #for each simulated experiment
x<-rnorm(n = N, mean = 110, sd = 10) #produce 1000 simulated participants
y<-rnorm(n = N, mean = 115, sd = 10) #produce 1000 simulated participants
z<-t.test(x,y) #perform the t-test
d<-smd(Mean.1= mean(x), Mean.2=mean(y), s.1=sd(x), s.2=sd(y), n.1=N, n.2=N, Unbiased=TRUE)
d_all[i]<-d
obs_pwr[i]<-pwr.t.test(n = N, d = d, sig.level = 0.05, type = "two.sample", alternative = "two.sided")$power
p[i]<-round(z$p.value,3) #get the p-value and store it
}
df2a <- data.frame(p,d_all,obs_pwr)
#Calculate power in simulation
power2a <- sum(p < 0.05)/nSims*100
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
coord_cartesian(ylim = c(0,250), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
coord_cartesian(ylim = c(0,100), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
ggplot(data = df2a, aes(x = p)) +
geom_histogram(binwidth = 0.01) +
geom_text(x = 0.7, y = 35, label = "Power: 20% \n Sample size: 10") +
coord_cartesian(ylim = c(0,80), xlim= c(0,1), expand = FALSE) +
geom_vline(xintercept = 0.05, colour = "red") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(),
axis.line = element_line(colour = "black"),
axis.text = element_text(colour = "black")) +
xlab("Observed p-value") +
ylab("Number of p-values")
